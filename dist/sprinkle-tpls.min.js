angular.module("mnd.sprinkle",[]).factory("MndWordProcessingService",function(){return function(n){var e={};if(2===n.length)e.left=n[0],e.pivot=n[1],e.right="";else{var i=Math.ceil(n.length/2-1);e.left=n.slice(0,i),e.right=n.slice(i+1),e.pivot=n.slice(i,i+1)}return e.multiplier=/[\,\:\;]$/g.test(n)?1.5:/[\.\!\?]$/g.test(n)?2:1,e}}).factory("MndWordSplittingService",function(){return function(n){var e=n.split(/\s+/);return e}}).directive("mndSprinkle",["$timeout","MndWordSplittingService","MndWordProcessingService",function(n,e,i){return{restrict:"EA",templateUrl:"templates/sprinkle.html",scope:{text:"@",defaultWpm:"@?",autoplay:"@?",autoplayDelay:"@?",progressPercentage:"=?"},link:function(r){r._words=e(r.text),r._wordIndex=0,r._msPerWord=function(){return Math.floor(6e4/r.wpm)},r.increaseSpeed=function(n){var e=r.wpm;e+=n||50,r.wpm=e},r.decreaseSpeed=function(n){var e=r.wpm;e-=n||50,50>e&&(e=50),r.wpm=e},r.wpm=parseInt(r.defaultWpm||"250",10);var t=function(){var e=r._words[r._wordIndex],s=i(e);r.word=s;var l=s.multiplier*r._msPerWord();r._wordIndex++,r.progressPercentage=r._wordIndex/r._words.length*100,r._wordIndex<r._words.length?r._timeout=n(t,l):(r.running=!1,r._wordIndex=0)};if(r.running=!1,r.start=function(){r.running||(r.running=!0,t())},r.pause=function(){r.running&&(n.cancel(r._timeout),r.running=!1)},r.rewind=function(){r._wordIndex=0},r.stop=function(){r.pause(),r.rewind()},"true"===r.autoplay){var s=parseInt(r.autoplayDelay,10),l=isNaN(s)?0:s;n(function(){r.start()},1e3*l)}}}}]),function(n){try{n=angular.module("mnd.sprinkle")}catch(e){n=angular.module("mnd.sprinkle",[])}n.run(["$templateCache",function(n){n.put("templates/sprinkle.html",'<div class="sprinkle-container">\n	<div class="sprinkle-result">\n		\n		<span class="sprinkle-left">\n			&nbsp;\n			{{word.left}}\n		</span>\n		<span class="sprinkle-pivot">\n			<div class="sprinkle-center-line-top"></div>\n			<div class="sprinkle-center-line-center"></div>\n			<div class="sprinkle-center-line-bottom"></div>	\n			{{word.pivot}}\n		</span>\n		<span class="sprinkle-right">\n			{{word.right}}\n		</span>\n	</div>\n	<div class="sprinkle-control-bar">\n		<div class="sprinkle-control-bar-left">\n			<div class="sprinkle-control-btn" ng-click="rewind()"><i class="fa fa-refresh"></i></div>\n			<div class="sprinkle-control-btn" ng-if="running" ng-click="pause()"><i class="fa fa-pause"></i></div>\n			<div class="sprinkle-control-btn" ng-if="!running" ng-click="start()"><i class="fa fa-play"></i></div>\n		</div>\n		<div class="sprinkle-control-bar-right">\n			<div class="sprinkle-control-btn" ng-click="decreaseSpeed()"><i class="fa fa-minus"></i></div>\n			<div class="sprinkle-control-wpm">{{wpm}} wpm </div>\n			<div class="sprinkle-control-btn" ng-click="increaseSpeed()"><i class="fa fa-plus"></i></div>\n		</div>\n	</div>\n</div>\n')}])}();